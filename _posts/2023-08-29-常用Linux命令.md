---
title: 读书笔记 —— 常用的Linux命令
authors: fanventory
date: 2023-08-29 17:27:00 +0800
categories: [八股文]
tags: [Linux]
---

# 常用的Linux命令
> 列出面试中可能问到的一些常用的Linux命令。

<br>
<br>

## 文件相关

1. pwd  
   查看当前路径位置
2. ls  
   查看当前路径文件夹
3. mkdir  
   创建文件夹
4. mv  
   移动文件或修改文件名字
5. touch  
   创建文件
6. rm -rf  
   删除文件
7. cp  
   复制文件
8. cat 或 head 或 tail  
   查看文件内容
9.  tar  
    打包

## 进程相关

1. ps -aux 或 ps -ef   
   两者都是查看进程，区别在于展示风格不同
2. kill -9  
    强制杀死进程
3. top  
   查看操作系统信息
4. free  
   查看内存使用情况

## 网络相关

1. tcpdump

网络抓包工具。

常用选项：

| 选项 | 含义 |
| -- | -- |
| -n | 使用IP地址表示主机，而不是主机名；使用数字表示端口号，而不是服务名 |
| -i | 指定要监听的网卡接口 |
| -v | 输出一个稍微详细的信息 |
| -t | 不打印时间戳 |
| -e | 显示以太网帧头部信息 |
| -c | 仅抓取指定数量的数据包 |
| -x | 以十六进制数显示数据包的内容，但不显示包中以太网帧的头部信息 |
| -X | 与-x类似，不过还打印每个十六进制字节对应的ASCII字符 |
| -XX | 与-X类似，不过还打印以太网帧的头部信息 |
| -s | 设置抓包时的抓取长度，当数据包的长度超过了抓取长度时，则截断 |
| -S | 以绝对值来显示TCP报文段的序号，而不是相对值 |
| -w | 将tcpdump的输出写入指定文件 |
| -r | 从文件读取数据包信息并显示 |

除了选项外，tcpdump还支持用表达式来进一步过滤数据包。表达式分为3种：  
+ 类型(type)

tcpdump支持的类型有：  
> host: 指定主机名或IP地址  
> net: 指定CIDR方法表示的网络地址(比如192.168.0.0/24)  
> port、portrange: 端口号和端口范围

命令格式：

```Shell
$ tcpdump net 192.168.0.0/24
```

+ 方向(dir)

tcpdump的方向有2种取值：  
> src: 指定数据包的发送端
> dst: 指定数据包的目的端

命令格式：  

```Shell
$ tcpdump dst port 13579
```

+ 协议proto

后接指定的目标协议。  
命令格式： 

```Shell
$ tcpdump icmp # 抓取所有ICMP的数据包
```

最后tcpdump还支持逻辑运算符，包括and(或者&&)、or(或者||)、not(或者!)，还支持括号(使用括号时需要用\转移或用单引号'括住)。

例子：  

```Shell
$ tcpdump 'src 10.0.2.4 and (dst port 3389 or 22)'
```

1. lsof

列出当前操作系统打开的文件描述符。

常用选项：  

| 选项 | 含义 | 可选值 |
| -- | -- | -- |
| -i | 显示socket文件描述符 | lsof -i \[46] \[protocol][@hostname\|ipaddr][:service\|port]，其中46表示IPv4和IPv6，protocol指定TCP或UDP，hostname指定主机名，ipaddr指定IP地址，service指定服务名，port指定端口号。(例子:losf -i @192.168.1.108:22) |
| -u | 显示目标用户启动的所有进程打开的文件描述符 | 用户名 |
| -c | 显示指定的命令打开的文件描述符 | 命令名称 |
| -p | 显示指定进程打开的文件描述符 | 进程号 |
| -t | 仅显示打开了目标文件描述符的进程PID | |

3. nc

快速构建网络连接。nc可以监听某个端口并接受客户连接，常用来调试客户端或服务端程序。

常用选项： 

| 选项 | 含义 | 可选值 |
| -- | -- | -- |
| -i | 设置数据包发送的时间间隔 | 单位为s |
| -l | 以服务器方式运行(默认以客户端方式运行) | |
| -k | 重复接受并处理某个端口上的所有连接，必须和-l一起使用 |
| -n | 使用IP地址表示主机，而不是主机名；使用数字表示端口号，而不是服务名 | |
| -p | 以客户端方式运行时，指定端口号 | |
| -s | 设置本地主机发送的数据包的IP地址 | |
| -C | 以CR和LF两个字符作为行结束符 | |
| -U | 使用UNIX本地域协议通信 | |
| -u | 使用UDP协议(默认使用TCP协议) | |
| -w | 如果nc客户端在指定时间内未检测到输入，则退出 | |
| -X | 当nc客户端和代理服务器通信时，指定通信协议 | 4(SOCKS v.4)、5(SOCKS v.5，默认值)、connect(HTTPS proxy) |
| -x | 指定目标代理服务器的IP地址和端口号 | nc -x IP地址:端口号 -X connect www.baidu.com |
| -z | 扫描目标机器上的某个或某些服务是否开启(端口扫描) | nc -z 主机名或IP 端口号或端口范围(用-隔开) |

4. strace

测试服务器性能的工具。它会跟踪程序运行过程中执行的系统调用和接收到的信号，并将系统调用、参数、返回值以及信号等信息输出。  

常用选项：

| 选项 | 含义 |
| -- | -- |
| -c | 统计每个系统调用的执行时间、执行次数和出错次数 | 
| -f | 跟踪由fork调用生成的子进程 |
| -t | 在每一行输出前加上时间信息 |
| -e | 指定一个表达式，用来控制如何跟踪系统调用(或接收到的信号) |
| -o | 将strace的输出写入指定文件 |

-e参数的表达式格式为\[qualifier=][!]value1\[,value2...]   
其中value有两个特殊的取值all和none。这里列举一些常用的表达式：  
+ -e trace=set: 跟踪指定的系统调用，比如-e trace=open,close,read,write
+ -e trace=file: 跟踪与文件操作相关的系统调用
+ -e trace=process: 跟踪与进程控制相关的系统调用
+ -e trace=network: 跟踪与网络相关的系统调用
+ -e trace=signal: 跟踪与信号相关的系统调用
+ -e trace=ipc: 跟踪与进程间通信相关的系统调用
+ -e signal=set: 跟踪指定的信号
+ -e read=set: 输出指定文件读入的数据，比如-e trace=3,5


5. netstat
   
统计网络信息，可以打印本地网卡接口上的全部连接、路由表信息、网卡接口信息等。

常用选项： 

| 选项 | 含义 |
| -- | -- |
| -n | 使用IP地址表示主机，而不是主机名；使用数字表示端口号，而不是服务名 | 
| -a | 显示结果中也包含监听socket | 
| -t | 仅显示TCP连接 | 
| -r | 显示路由信息 | 
| -i | 显示网卡接口的数据流量 |
| -c | 每隔1s输出一次 |
| -o | 显示socket定时器的信息 |
| -p | 显示socket所属的进程的PID和名字 |

6. vmstat

实时输出系统的各种资源的使用情况，比如进程信息、内存使用、CPU使用率和IO使用情况。

常用选项： 

| 选项 | 含义 |
| -- | -- |
| -f | 显示系统启动以来执行的fork次数 |
| -s | 显示内存相关的统计信息以及多种系统活动的数量(比如CPU上下文切换次数) |
| -d | 显示磁盘相关的的统计信息 |
| -p | 显示指定磁盘分区的统计信息 |
| -S | 使用指定的单位来显示(参数是k(1000)、K(1024)、m(1000000)、M(1048576)) |
| delay | 采样间隔(单位为s) |
| count | 采样次数 |

例子：  

```Shell
procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----
 r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st
101  0 998536 1319969792 282164 43680328    0    0    10     6    0    0 28  4 68  0  0
```

+ procs: 进程信息
  + r: 运行队列中的进程数量，即正在运行的线程数量+等待CPU资源的线程数量
  + b: 等待IO操作的进程数量
+ memory: 内存信息(默认单位是KB)
  + swpd: 虚拟内存的使用数量
  + free: 空闲内存的数量
  + buff: buffer cache(page cache)数量
+ swap: 交换分区(虚拟内存)的信息(单位是KB)
  + si: 数据从磁盘交换到内存的速率
  + so: 数据从内存交换到磁盘的速率
+ io: 块设备的使用信息(单位是block/s)
  + bi: 从块设备读入块的速率
  + bo: 表示向块设备写入块的速率
+ system: 系统信息
  + in: 每秒发生的中断次数
  + cs: 每秒发生的上下文切换次数
+ cpu: CPU使用信息
  + us: 表示系统所有进程运行在用户空间的时间占CPU总运行时间的比例
  + sy: 表示系统所有进程运行在内核空间的时间占CPU总运行时间的比例
  + id: 表示CPU处于空闲状态的时间占CPU总运行时间的比例
  + wa: 表示CPU等待IO事件的时间占CPU总运行时间的比例

7. ifstat

简单的网络流量检测工具。

常用选项： 

| 选项 | 含义 |
| -- | -- |
| -a | 检测系统行的所有网卡接口 |
| -i | 指定要检测的网卡接口 |
| -t | 每行输出信息前加上时间戳 |
| -b | 以Kbit/s为单位显示数据（默认是KB/s） |
| delay | 采样间隔（单位为s） |
| count | 采用次数 |

8. mpstat

检测多处理器系统上每个CPU的使用情况。

常用选项： 

| 选项 | 含义 | 可选值 |
| -- | -- | -- |
| -P | 指定要检测的CPU号 | 0~CPU个数-1，或ALL表示监听所有CPU |
| interval | 采样间隔 | 单位为s |
| count | 采样次数 | |

# Reference
[1] [说一说常用的 Linux 命令](https://www.nowcoder.com/exam/interview/72944761/test?paperId=50270072&order=0)  
[2] 《Linux高性能服务器编程》